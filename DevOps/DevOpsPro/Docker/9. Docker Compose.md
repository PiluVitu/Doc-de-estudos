É uma abstrção para se simplificar ao jeito de subir containers, evitando assim muitos comandos no bash e reunindo tudo em um arquivo declarativo yaml. 



## Comands

```bash
# Como executar unico docker compose na raiz ? 
docker compose up -d

# Como executar docker compose passando nome do arquivo ? 
docker compose -f <nome do arquivo> up -d

# Remove os containers do docker compose tudo de uma vez 
docker compose down

# Para os containers do compose 
docker compose stop

# Para executar um container novo e remover os containers orfãos de compose
docker compose up --remove-orphans

```


## Sintaxe 
```yaml

# Version é totalmente opcional 
version: "3.8"

volumes: 
	postgress_docker_vol:
		# Podemos definir um nome especifico para o volume
		name: postgre_exemplo_name
		# Se quisermos trabalhar com volumes definidos externamente 
		external: true

networks:
	# Aqui definimos o nome da nossa network que será criada
	kube_news_net:
		# Podemos definir o nome especifico para a network
		name: knews_net
		# Precisamos especificar o driver que iremos usar
		driver: bridge
		# Caso ele seja externo podemos sinalizar
		external: true

# Onde ficam os nosso container declarados
services: 
	nginx:
		# Csao queira definir um nome para o contaier
		container_name: nginxuru
		# Definir a imagem que o container vai usar
		image: nginx:latest
		# Definir o bind de porta do container 
		ports:
			# Porta do meu pc : Porta do container
			- "8081:80"
		#Caso eu queira rescrever o cmd do container
		command:
			- echo
			- Zawarudo
		# Podemos definir um alias para um ip do meu container, embora seja uma má pratica lidar com ips de container é uma opção
		extra_hosts:
			aula_docker.piluvitu.dev: "172.19.171.91"
		# Declarando dependencia para só subir esse container depois que o declarado for iniciado
		depends_on:
			- postgre

	postgre: 
		imagem: postgres:12.17
		ports:
			- 5432:3432
		# Desse jeito que declaramos variavies no nosso docker compose
		enviroments:
			POSTGRES_PASSWORD: 13245
			POSTGRES_USER: postgresdace
			POSTGRES_DB: sabonete
		# Podemos determinar volumes para persistir dados do container
		volumes:
			# Podemos fazer volume bind passando pasta no meu pc:pasta no container
			- ./postgre_vol:/var/lib/postgresql/data
			# Podemos usar o volume padrão
			- postgres_docker_vol:/var/lib/postgresql/data
		networks:
			- kube_news_net

	image_build:
	# É possivel declarar que um servoço irá subir com uma imagem que existe no repositorio e não alguma do docker hub
		image: piluvitu/imageteste:v2
		build:
			context: path do dockerfile
			dockerfile: nome do dockerfile

```

## Particuliaridades
- Caso tenha alguma mudança no compose, não é necessario parar o mesmo, você so precisa dar o comando compose up referenciando o compose correto e ele irá atualizar os containers modificados
- Caso você não especifique o nome para o container, o docker compose vai dar o nome como `nome do seu diretorio`-`nome do serviço`-`num que representa o container`(aula-nginx-1).
- Quando precisamos referenciar um container em alguma var, como sinalizar o host podemos usar o nome do serviço do container em vez do ip do mesmo